(this["webpackJsonpsupervisor-react"]=this["webpackJsonpsupervisor-react"]||[]).push([[0],{163:function(e,t){},165:function(e,t){},197:function(e,t,r){"use strict";r.r(t);var s,n=r(0),c=r(39),o=r.n(c),a=r(13),i=r(45),u=r(108),l=(r(153),r(154),r(155),r(156),r(59)),j=r.n(l),p=r(265),h=r(283),d=r(276),x=r(274),O=r(267),b=r(285),f=r(284),m=r(269),v=r(273),P=r(271),g=r(268),A=r(282),N=r(261),w=r(264),C=r(270),S=r(262),T=r(278),I=r(279),G=r(281),k=r(277),F=r(280),R=r(275),L=r(259),y=r(272),E=r(131),U=r.n(E),z=r(106),D=r.n(z),B=r(107),K=r.n(B),M=r(129),W=r.n(M),H=r(133),V=r.n(H),X=r(130),J=r.n(X),q=r(132),Q=r.n(q),Y=r(15),Z=r.n(Y),$=r(23),_=r(81),ee=r(158);!function(e){e[e.STOPPED=0]="STOPPED",e[e.STARTING=10]="STARTING",e[e.RUNNING=20]="RUNNING",e[e.BACKOFF=30]="BACKOFF",e[e.STOPPING=40]="STOPPING",e[e.EXITED=100]="EXITED",e[e.FATAL=200]="FATAL",e[e.UNKNOWN=1e3]="UNKNOWN"}(s||(s={}));s.STOPPED,s.EXITED,s.FATAL,s.UNKNOWN;var te,re=[s.STARTING,s.RUNNING,s.BACKOFF];!function(e){e[e.FATAL=2]="FATAL",e[e.RUNNING=1]="RUNNING",e[e.RESTARTING=0]="RESTARTING",e[e.SHUTDOWN=-1]="SHUTDOWN"}(te||(te={}));var se=function e(t){var r=this;Object(_.a)(this,e),this.client=void 0,this.setProcesses=void 0,this.methodCall=function(e,t){return new Promise((function(s,n){return r.client.methodCall(e,t,(function(e,t){return e?n(e):s(t)}))}))},this.getSupervisorVersion=function(){return r.methodCall("supervisor.getSupervisorVersion",[])},this.getState=Object($.a)(Z.a.mark((function e(){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.methodCall("supervisor.getState",[]);case 2:return e.abrupt("return",e.sent.statename);case 3:case"end":return e.stop()}}),e)}))),this.getAllProcessInfo=Object($.a)(Z.a.mark((function e(){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=r,e.next=4,r.methodCall("supervisor.getAllProcessInfo",[]);case 4:e.t1=e.sent,e.t0.setProcesses.call(e.t0,e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),r.setProcesses([]);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),this.startProcess=function(){var e=Object($.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.methodCall("supervisor.startProcess",["".concat(t.group,":").concat(t.name)]);case 2:return e.next=4,r.getAllProcessInfo();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.startProcessGroup=function(){var e=Object($.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.methodCall("supervisor.startProcessGroup",[t]);case 2:return e.next=4,r.getAllProcessInfo();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.startAllProcesses=Object($.a)(Z.a.mark((function e(){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.methodCall("supervisor.startAllProcesses",[]);case 2:return e.next=4,r.getAllProcessInfo();case 4:case"end":return e.stop()}}),e)}))),this.stopProcess=function(){var e=Object($.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.methodCall("supervisor.stopProcess",["".concat(t.group,":").concat(t.name)]);case 2:return e.next=4,r.getAllProcessInfo();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.stopProcessGroup=function(){var e=Object($.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.methodCall("supervisor.stopProcessGroup",[t]);case 2:return e.next=4,r.getAllProcessInfo();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.stopAllProcesses=Object($.a)(Z.a.mark((function e(){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.methodCall("supervisor.stopAllProcesses",[]);case 2:return e.next=4,r.getAllProcessInfo();case 4:case"end":return e.stop()}}),e)}))),this.restartProcess=function(){var e=Object($.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!re.includes(t.state)){e.next=4;break}return e.next=4,r.stopProcess(t);case 4:return e.prev=4,e.next=7,r.startProcess(t);case 7:return e.finish(4);case 8:case"end":return e.stop()}}),e,null,[[0,,4,8]])})));return function(t){return e.apply(this,arguments)}}(),this.restartProcessGroup=function(){var e=Object($.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.stopProcessGroup(t);case 2:return e.next=4,r.startProcessGroup(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.restartAllProcesses=Object($.a)(Z.a.mark((function e(){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.stopAllProcesses();case 2:return e.next=4,r.startAllProcesses();case 4:case"end":return e.stop()}}),e)}))),this.clearProcessLogs=function(e){return r.methodCall("supervisor.clearProcessLogs",["".concat(e.group,":").concat(e.name)])},this.clearAllProcessLogs=function(){return r.methodCall("supervisor.clearAllProcessLogs",[])},this.client=ee.createClient({host:window.location.hostname,port:window.location.port,path:"/RPC2"}),this.setProcesses=t},ne=r(2),ce=["title"],oe=["supervisor"],ae=function(e){var t=e.title,r=Object(u.a)(e,ce);return Object(ne.jsx)(L.a,{title:t,children:Object(ne.jsx)(O.a,{component:"span",children:Object(ne.jsx)(g.a,Object(i.a)({},r))})})},ie=function(e){var t=e.supervisor,r=Object(u.a)(e,oe),s=Object(n.useState)(""),c=Object(a.a)(s,2),o=c[0],l=c[1];return Object(n.useEffect)((function(){t.getSupervisorVersion().then(l)}),[]),Object(ne.jsxs)(m.a,Object(i.a)(Object(i.a)({},r),{},{children:[Object(ne.jsx)(P.a,{children:"About"}),Object(ne.jsx)(v.a,{dividers:!0,children:Object(ne.jsxs)("ul",{children:[Object(ne.jsxs)("li",{children:["supervisor: ",o]}),Object(ne.jsx)("li",{children:"supervisor-react: 0.2.2"})]})})]}))},ue=function(e){var t=e.supervisor,r=Object(n.useState)(null),s=Object(a.a)(r,2),c=s[0],o=s[1],i=Object(n.useState)(!1),u=Object(a.a)(i,2),l=u[0],j=u[1];return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(x.a,{position:"static",children:Object(ne.jsxs)(R.a,{children:[Object(ne.jsx)(g.a,{color:"inherit",onClick:function(e){return o(e.currentTarget)},children:Object(ne.jsx)(W.a,{})}),Object(ne.jsxs)(N.a,{anchorEl:c,open:null!==c,onClose:function(){return o(null)},children:[Object(ne.jsx)(w.a,{onClick:function(e){return t.stopAllProcesses()},children:"Stop all"}),Object(ne.jsx)(w.a,{onClick:function(e){return t.startAllProcesses()},children:"Start All"}),Object(ne.jsx)(w.a,{onClick:function(e){return t.restartAllProcesses()},children:"Restart All"}),Object(ne.jsx)(w.a,{onClick:function(e){return t.clearAllProcessLogs()},children:"Clear All"}),Object(ne.jsx)(w.a,{onClick:function(e){o(null),j(!0)},children:"About"})]}),Object(ne.jsx)(y.a,{variant:"h5",sx:{flexGrow:1},children:"Supervisor"}),Object(ne.jsx)(L.a,{title:"Reload Supervisor",children:Object(ne.jsx)(g.a,{color:"inherit",onClick:function(e){return t.getAllProcessInfo()},children:Object(ne.jsx)(J.a,{})})})]})}),Object(ne.jsx)(ie,{supervisor:t,open:l,onClose:function(){return j(!1)}})]})},le=function(e){var t=e.process,r=e.supervisor,n=re.includes(t.state)?r.stopProcess:r.startProcess;return Object(ne.jsx)(L.a,{title:t.name,children:Object(ne.jsx)(g.a,{size:"small",onClick:function(e){e.stopPropagation(),n(t)},children:re.includes(t.state)?Object(ne.jsx)(U.a,{sx:{color:"success.main"}}):t.state===s.FATAL?Object(ne.jsx)(D.a,{sx:{color:"error.main"}}):Object(ne.jsx)(D.a,{sx:{color:"warning.main"}})})})},je=function(e){var t=e.value,r=e.processes,n=e.supervisor,c=j.a.assign({RUNNING:0,STOPPED:0,FATAL:0},j.a.countBy(r,(function(e){return re.includes(e.state)?"RUNNING":e.state===s.FATAL?"FATAL":"STOPPED"})));return console.log(c),Object(ne.jsx)(d.a,{sx:{"&.Mui-expanded":{minHeight:0},"& .MuiAccordionSummary-content":{margin:0},"& .MuiAccordionSummary-content.Mui-expanded":{margin:0}},children:Object(ne.jsx)(k.a,{component:C.a,elevation:0,children:Object(ne.jsx)(T.a,{size:"small",children:Object(ne.jsx)(I.a,{children:Object(ne.jsxs)(F.a,{children:[Object(ne.jsx)(G.a,{width:200,children:t}),Object(ne.jsx)(G.a,{width:120}),Object(ne.jsx)(G.a,{align:"center",width:73,children:Object(ne.jsxs)(O.a,{component:"span",sx:{color:c.FATAL>0?"error.main":c.RUNNING===r.length?"success.main":"warning.main"},children:[c.RUNNING,"/",r.length]})}),Object(ne.jsx)(G.a,{children:r.map((function(e){return Object(ne.jsx)(le,{process:e,supervisor:n},e.name)}))}),Object(ne.jsxs)(G.a,{padding:"none",width:132,children:[Object(ne.jsx)(ae,{size:"small",title:"Stop Group",color:"primary",onClick:function(e){e.stopPropagation(),n.stopProcessGroup(t)},disabled:0===c.RUNNING,children:Object(ne.jsx)(Q.a,{fontSize:"small"})}),Object(ne.jsx)(ae,{size:"small",title:"Start Group",color:"primary",onClick:function(e){e.stopPropagation(),n.startProcessGroup(t)},disabled:c.RUNNING===r.length,children:Object(ne.jsx)(V.a,{fontSize:"small"})}),Object(ne.jsx)(ae,{size:"small",title:"Restart Group",color:"primary",onClick:function(e){e.stopPropagation(),n.restartProcessGroup(t)},children:Object(ne.jsx)(K.a,{fontSize:"small"})})]}),Object(ne.jsx)(G.a,{width:113})]})})})})})},pe=function(e){var t=e.process;return Object(ne.jsxs)(F.a,{children:[Object(ne.jsx)(G.a,{width:120}),Object(ne.jsx)(G.a,{width:200,children:t.name}),Object(ne.jsx)(G.a,{padding:"none",align:"center",width:73,children:Object(ne.jsx)(O.a,{component:"span",color:re.includes(t.state)?"success.main":t.state===s.FATAL?"error.main":"warning.main",children:t.statename})}),Object(ne.jsx)(G.a,{children:t.description}),Object(ne.jsxs)(G.a,{padding:"none",width:132,children:[Object(ne.jsx)(O.a,{component:"span",children:Object(ne.jsx)(S.a,{size:"small",checked:re.includes(t.state),onChange:function(r){return(re.includes(t.state)?e.supervisor.stopProcess:e.supervisor.startProcess)(t)}})}),Object(ne.jsx)(ae,{size:"small",title:"Restart",color:"primary",onClick:function(r){return e.supervisor.restartProcess(t)},children:Object(ne.jsx)(K.a,{fontSize:"small"})})]}),Object(ne.jsxs)(G.a,{width:113,children:[Object(ne.jsx)(A.a,{href:"logtail/".concat(t.group,":").concat(t.name),children:"stdout"}),"\xa0",Object(ne.jsx)(A.a,{href:"logtail/".concat(t.group,":").concat(t.name,"/stderr"),children:"stderr"})]})]})},he=function(e){return Object(ne.jsx)(h.a,{sx:{paddingTop:0,paddingBottom:0},children:Object(ne.jsx)(k.a,{children:Object(ne.jsx)(T.a,{size:"small",children:Object(ne.jsx)(I.a,{children:e.processes.map((function(t){return Object(ne.jsx)(pe,Object(i.a)({process:t},e),t.name)}))})})})})},de=function(e){return Object(ne.jsxs)(p.a,{elevation:0,sx:{"&.Mui-expanded":{margin:0}},children:[Object(ne.jsx)(je,Object(i.a)({},e)),Object(ne.jsx)(he,Object(i.a)({},e))]})},xe=function(){var e=Object(n.useState)([]),t=Object(a.a)(e,2),r=t[0],s=t[1],c=new se(s);return Object(n.useEffect)((function(){c.getAllProcessInfo()}),[]),Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(f.a,{}),Object(ne.jsxs)(b.a,{fixed:!0,children:[Object(ne.jsx)(ue,{supervisor:c}),j()(r).groupBy("group").toPairs().sortBy().map((function(e){var t=Object(a.a)(e,2),r=t[0],s=t[1];return Object(ne.jsx)(de,{value:r,processes:j.a.sortBy(s,"name"),supervisor:c},r)})).value()]})]})},Oe=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,286)).then((function(t){var r=t.getCLS,s=t.getFID,n=t.getFCP,c=t.getLCP,o=t.getTTFB;r(e),s(e),n(e),c(e),o(e)}))};o.a.render(Object(ne.jsx)(n.StrictMode,{children:Object(ne.jsx)(xe,{})}),document.getElementById("root")),Oe()}},[[197,1,2]]]);