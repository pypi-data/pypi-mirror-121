{"ast":null,"code":"var __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) {\n    s += arguments[i].length;\n  }\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) {\n    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) {\n      r[k] = a[j];\n    }\n  }\n\n  return r;\n};\n\nimport { getExcelColumnName } from '../../assets/excelUtils';\nimport cellFactory from './cell';\n\nvar addEmptyCells = function addEmptyCells(cells, rowIdx) {\n  var mergeMap = [];\n  var posCounter = 0;\n\n  for (var i = 0; i < cells.length; i++) {\n    var cell = cells[i];\n\n    if (cell.mergeAcross) {\n      mergeMap.push({\n        pos: i,\n        excelPos: posCounter\n      });\n      posCounter += cell.mergeAcross;\n    }\n\n    posCounter++;\n  }\n\n  if (mergeMap.length) {\n    for (var i = mergeMap.length - 1; i >= 0; i--) {\n      var mergedCells = [];\n      var cell = cells[mergeMap[i].pos];\n\n      for (var j = 1; j <= cell.mergeAcross; j++) {\n        mergedCells.push({\n          ref: \"\" + getExcelColumnName(mergeMap[i].excelPos + 1 + j) + (rowIdx + 1),\n          styleId: cell.styleId,\n          data: {\n            type: 'empty',\n            value: null\n          }\n        });\n      }\n\n      if (mergedCells.length) {\n        cells.splice.apply(cells, __spreadArrays([mergeMap[i].pos + 1, 0], mergedCells));\n      }\n    }\n  }\n};\n\nvar shouldDisplayCell = function shouldDisplayCell(cell) {\n  return cell.data.value !== '' || cell.styleId !== undefined;\n};\n\nvar rowFactory = {\n  getTemplate: function getTemplate(config, idx, currentSheet) {\n    var index = config.index,\n        collapsed = config.collapsed,\n        hidden = config.hidden,\n        height = config.height,\n        s = config.s,\n        _a = config.cells,\n        cells = _a === void 0 ? [] : _a;\n    addEmptyCells(cells, idx);\n    var children = cells.filter(shouldDisplayCell).map(function (cell, idx) {\n      return cellFactory.getTemplate(cell, idx, currentSheet);\n    });\n    return {\n      name: \"row\",\n      properties: {\n        rawMap: {\n          r: index,\n          collapsed: collapsed,\n          hidden: hidden ? '1' : '0',\n          ht: height,\n          customHeight: height != null ? '1' : '0',\n          s: s,\n          customFormat: s != null ? '1' : '0'\n        }\n      },\n      children: children\n    };\n  }\n};\nexport default rowFactory;","map":{"version":3,"sources":["C:/dev/streamlit-aggrid/st_aggrid/frontend/node_modules/@ag-grid-enterprise/excel-export/dist/es6/excelExport/files/ooxml/row.js"],"names":["__spreadArrays","s","i","il","arguments","length","r","Array","k","a","j","jl","getExcelColumnName","cellFactory","addEmptyCells","cells","rowIdx","mergeMap","posCounter","cell","mergeAcross","push","pos","excelPos","mergedCells","ref","styleId","data","type","value","splice","apply","shouldDisplayCell","undefined","rowFactory","getTemplate","config","idx","currentSheet","index","collapsed","hidden","height","_a","children","filter","map","name","properties","rawMap","ht","customHeight","customFormat"],"mappings":"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","sourcesContent":["var __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { getExcelColumnName } from '../../assets/excelUtils';\nimport cellFactory from './cell';\nvar addEmptyCells = function (cells, rowIdx) {\n    var mergeMap = [];\n    var posCounter = 0;\n    for (var i = 0; i < cells.length; i++) {\n        var cell = cells[i];\n        if (cell.mergeAcross) {\n            mergeMap.push({\n                pos: i,\n                excelPos: posCounter\n            });\n            posCounter += cell.mergeAcross;\n        }\n        posCounter++;\n    }\n    if (mergeMap.length) {\n        for (var i = mergeMap.length - 1; i >= 0; i--) {\n            var mergedCells = [];\n            var cell = cells[mergeMap[i].pos];\n            for (var j = 1; j <= cell.mergeAcross; j++) {\n                mergedCells.push({\n                    ref: \"\" + getExcelColumnName(mergeMap[i].excelPos + 1 + j) + (rowIdx + 1),\n                    styleId: cell.styleId,\n                    data: { type: 'empty', value: null }\n                });\n            }\n            if (mergedCells.length) {\n                cells.splice.apply(cells, __spreadArrays([mergeMap[i].pos + 1, 0], mergedCells));\n            }\n        }\n    }\n};\nvar shouldDisplayCell = function (cell) { return cell.data.value !== '' || cell.styleId !== undefined; };\nvar rowFactory = {\n    getTemplate: function (config, idx, currentSheet) {\n        var index = config.index, collapsed = config.collapsed, hidden = config.hidden, height = config.height, s = config.s, _a = config.cells, cells = _a === void 0 ? [] : _a;\n        addEmptyCells(cells, idx);\n        var children = cells.filter(shouldDisplayCell).map(function (cell, idx) { return cellFactory.getTemplate(cell, idx, currentSheet); });\n        return {\n            name: \"row\",\n            properties: {\n                rawMap: {\n                    r: index,\n                    collapsed: collapsed,\n                    hidden: hidden ? '1' : '0',\n                    ht: height,\n                    customHeight: height != null ? '1' : '0',\n                    s: s,\n                    customFormat: s != null ? '1' : '0'\n                }\n            },\n            children: children\n        };\n    }\n};\nexport default rowFactory;\n"]},"metadata":{},"sourceType":"module"}