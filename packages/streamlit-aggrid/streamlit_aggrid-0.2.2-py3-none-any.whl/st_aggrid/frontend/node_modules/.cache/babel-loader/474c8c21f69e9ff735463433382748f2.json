{"ast":null,"code":"import { _ } from '@ag-grid-community/core';\nimport { getStyleId } from './styles/stylesheet';\n\nvar convertLegacyType = function (type) {\n  var t = type.charAt(0).toLowerCase();\n  return t === 's' ? 'inlineStr' : t;\n};\n\nvar cellFactory = {\n  getTemplate: function (config, idx, currentSheet) {\n    var ref = config.ref,\n        data = config.data,\n        styleId = config.styleId;\n    var type = data.type,\n        value = data.value;\n    var convertedType = type;\n\n    if (type === 'f') {\n      convertedType = 'str';\n    } else if (type.charAt(0) === type.charAt(0).toUpperCase()) {\n      convertedType = convertLegacyType(type);\n    }\n\n    var obj = {\n      name: 'c',\n      properties: {\n        rawMap: {\n          r: ref,\n          t: convertedType === 'empty' ? undefined : convertedType,\n          s: styleId ? getStyleId(styleId, currentSheet) : undefined\n        }\n      }\n    };\n\n    if (convertedType === 'empty') {\n      return obj;\n    }\n\n    var children;\n\n    if (convertedType === 'str' && type === 'f') {\n      children = [{\n        name: 'f',\n        textNode: _.escapeString(_.utf8_encode(value))\n      }];\n    } else if (convertedType === 'inlineStr') {\n      children = [{\n        name: 'is',\n        children: [{\n          name: 't',\n          textNode: _.escapeString(_.utf8_encode(value))\n        }]\n      }];\n    } else {\n      children = [{\n        name: 'v',\n        textNode: value\n      }];\n    }\n\n    return _.assign({}, obj, {\n      children: children\n    });\n  }\n};\nexport default cellFactory;","map":{"version":3,"sources":["C:/dev/streamlit-aggrid/st_aggrid/frontend/node_modules/@ag-grid-enterprise/excel-export/dist/es6/excelExport/files/ooxml/cell.js"],"names":["_","getStyleId","convertLegacyType","type","t","charAt","toLowerCase","cellFactory","getTemplate","config","idx","currentSheet","ref","data","styleId","value","convertedType","toUpperCase","obj","name","properties","rawMap","r","undefined","s","children","textNode","escapeString","utf8_encode","assign"],"mappings":"AAAA,SAASA,CAAT,QAAkB,yBAAlB;AACA,SAASC,UAAT,QAA2B,qBAA3B;;AACA,IAAIC,iBAAiB,GAAG,UAAUC,IAAV,EAAgB;AACpC,MAAIC,CAAC,GAAGD,IAAI,CAACE,MAAL,CAAY,CAAZ,EAAeC,WAAf,EAAR;AACA,SAAOF,CAAC,KAAK,GAAN,GAAY,WAAZ,GAA0BA,CAAjC;AACH,CAHD;;AAIA,IAAIG,WAAW,GAAG;AACdC,EAAAA,WAAW,EAAE,UAAUC,MAAV,EAAkBC,GAAlB,EAAuBC,YAAvB,EAAqC;AAC9C,QAAIC,GAAG,GAAGH,MAAM,CAACG,GAAjB;AAAA,QAAsBC,IAAI,GAAGJ,MAAM,CAACI,IAApC;AAAA,QAA0CC,OAAO,GAAGL,MAAM,CAACK,OAA3D;AACA,QAAIX,IAAI,GAAGU,IAAI,CAACV,IAAhB;AAAA,QAAsBY,KAAK,GAAGF,IAAI,CAACE,KAAnC;AACA,QAAIC,aAAa,GAAGb,IAApB;;AACA,QAAIA,IAAI,KAAK,GAAb,EAAkB;AACda,MAAAA,aAAa,GAAG,KAAhB;AACH,KAFD,MAGK,IAAIb,IAAI,CAACE,MAAL,CAAY,CAAZ,MAAmBF,IAAI,CAACE,MAAL,CAAY,CAAZ,EAAeY,WAAf,EAAvB,EAAqD;AACtDD,MAAAA,aAAa,GAAGd,iBAAiB,CAACC,IAAD,CAAjC;AACH;;AACD,QAAIe,GAAG,GAAG;AACNC,MAAAA,IAAI,EAAE,GADA;AAENC,MAAAA,UAAU,EAAE;AACRC,QAAAA,MAAM,EAAE;AACJC,UAAAA,CAAC,EAAEV,GADC;AAEJR,UAAAA,CAAC,EAAEY,aAAa,KAAK,OAAlB,GAA4BO,SAA5B,GAAwCP,aAFvC;AAGJQ,UAAAA,CAAC,EAAEV,OAAO,GAAGb,UAAU,CAACa,OAAD,EAAUH,YAAV,CAAb,GAAuCY;AAH7C;AADA;AAFN,KAAV;;AAUA,QAAIP,aAAa,KAAK,OAAtB,EAA+B;AAC3B,aAAOE,GAAP;AACH;;AACD,QAAIO,QAAJ;;AACA,QAAIT,aAAa,KAAK,KAAlB,IAA2Bb,IAAI,KAAK,GAAxC,EAA6C;AACzCsB,MAAAA,QAAQ,GAAG,CAAC;AACJN,QAAAA,IAAI,EAAE,GADF;AAEJO,QAAAA,QAAQ,EAAE1B,CAAC,CAAC2B,YAAF,CAAe3B,CAAC,CAAC4B,WAAF,CAAcb,KAAd,CAAf;AAFN,OAAD,CAAX;AAIH,KALD,MAMK,IAAIC,aAAa,KAAK,WAAtB,EAAmC;AACpCS,MAAAA,QAAQ,GAAG,CAAC;AACJN,QAAAA,IAAI,EAAE,IADF;AAEJM,QAAAA,QAAQ,EAAE,CAAC;AACHN,UAAAA,IAAI,EAAE,GADH;AAEHO,UAAAA,QAAQ,EAAE1B,CAAC,CAAC2B,YAAF,CAAe3B,CAAC,CAAC4B,WAAF,CAAcb,KAAd,CAAf;AAFP,SAAD;AAFN,OAAD,CAAX;AAOH,KARI,MASA;AACDU,MAAAA,QAAQ,GAAG,CAAC;AACJN,QAAAA,IAAI,EAAE,GADF;AAEJO,QAAAA,QAAQ,EAAEX;AAFN,OAAD,CAAX;AAIH;;AACD,WAAOf,CAAC,CAAC6B,MAAF,CAAS,EAAT,EAAaX,GAAb,EAAkB;AAAEO,MAAAA,QAAQ,EAAEA;AAAZ,KAAlB,CAAP;AACH;AA/Ca,CAAlB;AAiDA,eAAelB,WAAf","sourcesContent":["import { _ } from '@ag-grid-community/core';\nimport { getStyleId } from './styles/stylesheet';\nvar convertLegacyType = function (type) {\n    var t = type.charAt(0).toLowerCase();\n    return t === 's' ? 'inlineStr' : t;\n};\nvar cellFactory = {\n    getTemplate: function (config, idx, currentSheet) {\n        var ref = config.ref, data = config.data, styleId = config.styleId;\n        var type = data.type, value = data.value;\n        var convertedType = type;\n        if (type === 'f') {\n            convertedType = 'str';\n        }\n        else if (type.charAt(0) === type.charAt(0).toUpperCase()) {\n            convertedType = convertLegacyType(type);\n        }\n        var obj = {\n            name: 'c',\n            properties: {\n                rawMap: {\n                    r: ref,\n                    t: convertedType === 'empty' ? undefined : convertedType,\n                    s: styleId ? getStyleId(styleId, currentSheet) : undefined\n                }\n            }\n        };\n        if (convertedType === 'empty') {\n            return obj;\n        }\n        var children;\n        if (convertedType === 'str' && type === 'f') {\n            children = [{\n                    name: 'f',\n                    textNode: _.escapeString(_.utf8_encode(value))\n                }];\n        }\n        else if (convertedType === 'inlineStr') {\n            children = [{\n                    name: 'is',\n                    children: [{\n                            name: 't',\n                            textNode: _.escapeString(_.utf8_encode(value))\n                        }]\n                }];\n        }\n        else {\n            children = [{\n                    name: 'v',\n                    textNode: value\n                }];\n        }\n        return _.assign({}, obj, { children: children });\n    }\n};\nexport default cellFactory;\n"]},"metadata":{},"sourceType":"module"}