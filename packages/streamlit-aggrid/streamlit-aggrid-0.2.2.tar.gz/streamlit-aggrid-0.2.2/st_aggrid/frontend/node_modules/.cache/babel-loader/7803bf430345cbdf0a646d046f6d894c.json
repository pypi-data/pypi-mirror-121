{"ast":null,"code":"import { _ } from '@ag-grid-community/core';\n\nvar buildSharedString = function (strMap) {\n  var ret = [];\n  strMap.forEach(function (val, key) {\n    var textNode = key.toString();\n    var child = {\n      name: 't',\n      textNode: _.utf8_encode(_.escapeString(textNode))\n    }; // if we have leading or trailing spaces, instruct Excel not to trim them\n\n    var preserveSpaces = textNode.replace(/^\\s*|\\s*$/g, '').length !== textNode.length;\n\n    if (preserveSpaces) {\n      child.properties = {\n        rawMap: {\n          \"xml:space\": \"preserve\"\n        }\n      };\n    }\n\n    ret.push({\n      name: 'si',\n      children: [child]\n    });\n  });\n  return ret;\n};\n\nvar sharedStrings = {\n  getTemplate: function (strings) {\n    return {\n      name: \"sst\",\n      properties: {\n        rawMap: {\n          xmlns: 'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\n          count: strings.size,\n          uniqueCount: strings.size\n        }\n      },\n      children: buildSharedString(strings)\n    };\n  }\n};\nexport default sharedStrings;","map":{"version":3,"sources":["C:/dev/streamlit-aggrid/st_aggrid/frontend/node_modules/@ag-grid-enterprise/excel-export/dist/es6/excelExport/files/ooxml/sharedStrings.js"],"names":["_","buildSharedString","strMap","ret","forEach","val","key","textNode","toString","child","name","utf8_encode","escapeString","preserveSpaces","replace","length","properties","rawMap","push","children","sharedStrings","getTemplate","strings","xmlns","count","size","uniqueCount"],"mappings":"AAAA,SAASA,CAAT,QAAkB,yBAAlB;;AACA,IAAIC,iBAAiB,GAAG,UAAUC,MAAV,EAAkB;AACtC,MAAIC,GAAG,GAAG,EAAV;AACAD,EAAAA,MAAM,CAACE,OAAP,CAAe,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AAC/B,QAAIC,QAAQ,GAAGD,GAAG,CAACE,QAAJ,EAAf;AACA,QAAIC,KAAK,GAAG;AACRC,MAAAA,IAAI,EAAE,GADE;AAERH,MAAAA,QAAQ,EAAEP,CAAC,CAACW,WAAF,CAAcX,CAAC,CAACY,YAAF,CAAeL,QAAf,CAAd;AAFF,KAAZ,CAF+B,CAM/B;;AACA,QAAIM,cAAc,GAAGN,QAAQ,CAACO,OAAT,CAAiB,YAAjB,EAA+B,EAA/B,EAAmCC,MAAnC,KAA8CR,QAAQ,CAACQ,MAA5E;;AACA,QAAIF,cAAJ,EAAoB;AAChBJ,MAAAA,KAAK,CAACO,UAAN,GAAmB;AACfC,QAAAA,MAAM,EAAE;AACJ,uBAAa;AADT;AADO,OAAnB;AAKH;;AACDd,IAAAA,GAAG,CAACe,IAAJ,CAAS;AACLR,MAAAA,IAAI,EAAE,IADD;AAELS,MAAAA,QAAQ,EAAE,CAACV,KAAD;AAFL,KAAT;AAIH,GAnBD;AAoBA,SAAON,GAAP;AACH,CAvBD;;AAwBA,IAAIiB,aAAa,GAAG;AAChBC,EAAAA,WAAW,EAAE,UAAUC,OAAV,EAAmB;AAC5B,WAAO;AACHZ,MAAAA,IAAI,EAAE,KADH;AAEHM,MAAAA,UAAU,EAAE;AACRC,QAAAA,MAAM,EAAE;AACJM,UAAAA,KAAK,EAAE,2DADH;AAEJC,UAAAA,KAAK,EAAEF,OAAO,CAACG,IAFX;AAGJC,UAAAA,WAAW,EAAEJ,OAAO,CAACG;AAHjB;AADA,OAFT;AASHN,MAAAA,QAAQ,EAAElB,iBAAiB,CAACqB,OAAD;AATxB,KAAP;AAWH;AAbe,CAApB;AAeA,eAAeF,aAAf","sourcesContent":["import { _ } from '@ag-grid-community/core';\nvar buildSharedString = function (strMap) {\n    var ret = [];\n    strMap.forEach(function (val, key) {\n        var textNode = key.toString();\n        var child = {\n            name: 't',\n            textNode: _.utf8_encode(_.escapeString(textNode))\n        };\n        // if we have leading or trailing spaces, instruct Excel not to trim them\n        var preserveSpaces = textNode.replace(/^\\s*|\\s*$/g, '').length !== textNode.length;\n        if (preserveSpaces) {\n            child.properties = {\n                rawMap: {\n                    \"xml:space\": \"preserve\"\n                }\n            };\n        }\n        ret.push({\n            name: 'si',\n            children: [child]\n        });\n    });\n    return ret;\n};\nvar sharedStrings = {\n    getTemplate: function (strings) {\n        return {\n            name: \"sst\",\n            properties: {\n                rawMap: {\n                    xmlns: 'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\n                    count: strings.size,\n                    uniqueCount: strings.size\n                }\n            },\n            children: buildSharedString(strings)\n        };\n    }\n};\nexport default sharedStrings;\n"]},"metadata":{},"sourceType":"module"}