{"ast":null,"code":"import { ExcelFactoryMode, _ } from '@ag-grid-community/core';\nimport workbook from './files/xml/workbook';\nimport excelWorkbook from './files/xml/excelWorkbook';\nimport worksheet from './files/xml/worksheet';\nimport documentProperties from './files/xml/documentProperties';\nimport alignment from './files/xml/styles/alignment';\nimport borders from './files/xml/styles/borders';\nimport font from './files/xml/styles/font';\nimport interior from './files/xml/styles/interior';\nimport protection from './files/xml/styles/protection';\nimport numberFormat from './files/xml/styles/numberFormat';\nimport style from './files/xml/styles/style';\nimport { XmlFactory } from \"@ag-grid-community/csv-export\";\n/**\n * See https://msdn.microsoft.com/en-us/library/aa140066(v=office.10).aspx\n */\n\nvar ExcelXmlFactory = function () {\n  function ExcelXmlFactory() {}\n\n  ExcelXmlFactory.createExcel = function (styles, currentWorksheet) {\n    var header = this.excelXmlHeader();\n    var docProps = documentProperties.getTemplate();\n    var eWorkbook = excelWorkbook.getTemplate();\n    var wb = this.workbook(docProps, eWorkbook, styles, currentWorksheet);\n    return \"\" + header + XmlFactory.createXml(wb, function (boolean) {\n      return boolean ? '1' : '0';\n    });\n  };\n\n  ExcelXmlFactory.workbook = function (docProperties, eWorkbook, styles, currentWorksheet) {\n    var children = [docProperties, eWorkbook, this.stylesXmlElement(styles)].concat(worksheet.getTemplate(currentWorksheet));\n    return _.assign({}, workbook.getTemplate(), {\n      children: children\n    });\n  };\n\n  ExcelXmlFactory.excelXmlHeader = function () {\n    return \"<?xml version=\\\"1.0\\\" ?>\\n        <?mso-application progid=\\\"Excel.Sheet\\\" ?>\\n        \";\n  };\n\n  ExcelXmlFactory.stylesXmlElement = function (styles) {\n    var _this = this;\n\n    return {\n      name: 'Styles',\n      children: styles ? styles.map(function (it) {\n        return _this.styleXmlElement(it);\n      }) : []\n    };\n  };\n\n  ExcelXmlFactory.styleXmlElement = function (styleProperties) {\n    var children = _.compose(this.addProperty('alignment', styleProperties), this.addProperty('borders', styleProperties), this.addProperty('font', styleProperties), this.addProperty('interior', styleProperties), this.addProperty('protection', styleProperties), this.addProperty('numberFormat', styleProperties))([]);\n\n    return _.assign({}, style.getTemplate(styleProperties), {\n      children: children\n    });\n  };\n\n  ExcelXmlFactory.addProperty = function (property, styleProperties) {\n    return function (children) {\n      if (!styleProperties[property]) {\n        return children;\n      }\n\n      var options = {\n        alignment: alignment,\n        borders: borders,\n        font: font,\n        interior: interior,\n        numberFormat: numberFormat,\n        protection: protection\n      };\n      return children.concat(options[property].getTemplate(styleProperties));\n    };\n  };\n\n  ExcelXmlFactory.factoryMode = ExcelFactoryMode.SINGLE_SHEET;\n  return ExcelXmlFactory;\n}();\n\nexport { ExcelXmlFactory };","map":{"version":3,"sources":["C:/dev/streamlit-aggrid/st_aggrid/frontend/node_modules/@ag-grid-enterprise/excel-export/dist/es6/excelExport/excelXmlFactory.js"],"names":["ExcelFactoryMode","_","workbook","excelWorkbook","worksheet","documentProperties","alignment","borders","font","interior","protection","numberFormat","style","XmlFactory","ExcelXmlFactory","createExcel","styles","currentWorksheet","header","excelXmlHeader","docProps","getTemplate","eWorkbook","wb","createXml","boolean","docProperties","children","stylesXmlElement","concat","assign","_this","name","map","it","styleXmlElement","styleProperties","compose","addProperty","property","options","factoryMode","SINGLE_SHEET"],"mappings":"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","sourcesContent":["import { ExcelFactoryMode, _ } from '@ag-grid-community/core';\nimport workbook from './files/xml/workbook';\nimport excelWorkbook from './files/xml/excelWorkbook';\nimport worksheet from './files/xml/worksheet';\nimport documentProperties from './files/xml/documentProperties';\nimport alignment from './files/xml/styles/alignment';\nimport borders from './files/xml/styles/borders';\nimport font from './files/xml/styles/font';\nimport interior from './files/xml/styles/interior';\nimport protection from './files/xml/styles/protection';\nimport numberFormat from './files/xml/styles/numberFormat';\nimport style from './files/xml/styles/style';\nimport { XmlFactory } from \"@ag-grid-community/csv-export\";\n/**\n * See https://msdn.microsoft.com/en-us/library/aa140066(v=office.10).aspx\n */\nvar ExcelXmlFactory = /** @class */ (function () {\n    function ExcelXmlFactory() {\n    }\n    ExcelXmlFactory.createExcel = function (styles, currentWorksheet) {\n        var header = this.excelXmlHeader();\n        var docProps = documentProperties.getTemplate();\n        var eWorkbook = excelWorkbook.getTemplate();\n        var wb = this.workbook(docProps, eWorkbook, styles, currentWorksheet);\n        return \"\" + header + XmlFactory.createXml(wb, function (boolean) { return boolean ? '1' : '0'; });\n    };\n    ExcelXmlFactory.workbook = function (docProperties, eWorkbook, styles, currentWorksheet) {\n        var children = [\n            docProperties,\n            eWorkbook,\n            this.stylesXmlElement(styles)\n        ].concat(worksheet.getTemplate(currentWorksheet));\n        return _.assign({}, workbook.getTemplate(), { children: children });\n    };\n    ExcelXmlFactory.excelXmlHeader = function () {\n        return \"<?xml version=\\\"1.0\\\" ?>\\n        <?mso-application progid=\\\"Excel.Sheet\\\" ?>\\n        \";\n    };\n    ExcelXmlFactory.stylesXmlElement = function (styles) {\n        var _this = this;\n        return {\n            name: 'Styles',\n            children: styles ? styles.map(function (it) { return _this.styleXmlElement(it); }) : []\n        };\n    };\n    ExcelXmlFactory.styleXmlElement = function (styleProperties) {\n        var children = _.compose(this.addProperty('alignment', styleProperties), this.addProperty('borders', styleProperties), this.addProperty('font', styleProperties), this.addProperty('interior', styleProperties), this.addProperty('protection', styleProperties), this.addProperty('numberFormat', styleProperties))([]);\n        return _.assign({}, style.getTemplate(styleProperties), { children: children });\n    };\n    ExcelXmlFactory.addProperty = function (property, styleProperties) {\n        return function (children) {\n            if (!styleProperties[property]) {\n                return children;\n            }\n            var options = {\n                alignment: alignment,\n                borders: borders,\n                font: font,\n                interior: interior,\n                numberFormat: numberFormat,\n                protection: protection\n            };\n            return children.concat(options[property].getTemplate(styleProperties));\n        };\n    };\n    ExcelXmlFactory.factoryMode = ExcelFactoryMode.SINGLE_SHEET;\n    return ExcelXmlFactory;\n}());\nexport { ExcelXmlFactory };\n"]},"metadata":{},"sourceType":"module"}