(self["webpackChunkunmanic_frontend"]=self["webpackChunkunmanic_frontend"]||[]).push([[988],{4988:(e,l,n)=>{"use strict";n.r(l),n.d(l,{default:()=>z});var t=n(3673),a=n(2323);const r={class:"q-pa-none"},i={class:"row"},o={class:"col q-ma-sm"},s={class:"q-pa-md",style:{"max-width":"400px"}},c={class:"q-mb-none"},u={class:"q-mb-none"},b={class:"q-gutter-sm"},y={class:"q-gutter-sm"},m={class:"q-gutter-sm"},d={class:"q-mb-none"},p={class:"q-gutter-sm"},h={key:0},g={class:"row"},S=(0,t.Wm)("div",{class:"col-6 text-center"},null,-1),k={class:"col-6 text-center"},w=(0,t.Uk)(" Workers ");function f(e,l,n,f,q,_){const L=(0,t.up)("q-skeleton"),v=(0,t.up)("q-icon"),W=(0,t.up)("q-input"),$=(0,t.up)("q-separator"),V=(0,t.up)("q-toggle"),F=(0,t.up)("q-btn"),P=(0,t.up)("q-form"),Q=(0,t.up)("q-card"),j=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(j,{padding:""},{default:(0,t.w5)((()=>[(0,t.Wm)("div",r,[(0,t.Wm)("div",i,[(0,t.Wm)("div",o,[(0,t.Wm)("div",s,[(0,t.Wm)(P,{onSubmit:_.save,class:"q-gutter-md"},{default:(0,t.w5)((()=>[(0,t.Wm)("h5",c,(0,a.zw)(e.$t("components.settings.library.path")),1),null===q.libraryPath?((0,t.wg)(),(0,t.j4)(L,{key:0,type:"QInput"})):((0,t.wg)(),(0,t.j4)(W,{key:1,readonly:"",outlined:"",color:"primary",modelValue:q.libraryPath,"onUpdate:modelValue":l[1]||(l[1]=e=>q.libraryPath=e),label:e.$t("components.settings.library.path"),placeholder:q.libraryPath,onClick:_.updateLibraryWithDirectoryBrowser},{append:(0,t.w5)((()=>[(0,t.Wm)(v,{onClick:_.updateLibraryWithDirectoryBrowser,class:"cursor-pointer",name:"folder_open"},null,8,["onClick"])])),_:1},8,["modelValue","label","placeholder","onClick"])),(0,t.Wm)($,{class:"q-my-lg"}),(0,t.Wm)("h5",u,(0,a.zw)(e.$t("components.settings.library.libraryScanner")),1),(0,t.Wm)("div",b,[null===q.enableLibraryScanner?((0,t.wg)(),(0,t.j4)(L,{key:0,type:"QToggle"})):((0,t.wg)(),(0,t.j4)(V,{key:1,modelValue:q.enableLibraryScanner,"onUpdate:modelValue":l[2]||(l[2]=e=>q.enableLibraryScanner=e),label:e.$t("components.settings.library.enableLibraryScanner")},null,8,["modelValue","label"]))]),null===q.libraryScanSchedule?((0,t.wg)(),(0,t.j4)(L,{key:2,type:"QInput"})):(0,t.kq)("",!0),q.enableLibraryScanner&&null!==q.libraryScanSchedule?((0,t.wg)(),(0,t.j4)(W,{key:3,outlined:"",type:"number",modelValue:q.libraryScanSchedule,"onUpdate:modelValue":l[3]||(l[3]=e=>q.libraryScanSchedule=e),label:e.$t("components.settings.library.libraryScannerSchedule"),"lazy-rules":"",rules:[l=>null!==l&&""!==l||e.$t("components.settings.library.libraryScannerScheduleNotValid"),l=>l>0||e.$t("components.settings.pleaseEnterAValidNumber")]},null,8,["modelValue","label","rules"])):(0,t.kq)("",!0),(0,t.Wm)("div",y,[null===q.libraryScanFollowSymlinks?((0,t.wg)(),(0,t.j4)(L,{key:0,type:"QToggle"})):(0,t.kq)("",!0),q.enableLibraryScanner&&null!==q.libraryScanFollowSymlinks?((0,t.wg)(),(0,t.j4)(V,{key:1,modelValue:q.libraryScanFollowSymlinks,"onUpdate:modelValue":l[4]||(l[4]=e=>q.libraryScanFollowSymlinks=e),label:e.$t("components.settings.library.followSymlinks")},null,8,["modelValue","label"])):(0,t.kq)("",!0)]),(0,t.Wm)("div",m,[null===q.runLibraryScanOnStart?((0,t.wg)(),(0,t.j4)(L,{key:0,type:"QToggle"})):(0,t.kq)("",!0),q.enableLibraryScanner&&null!==q.runLibraryScanOnStart?((0,t.wg)(),(0,t.j4)(V,{key:1,modelValue:q.runLibraryScanOnStart,"onUpdate:modelValue":l[5]||(l[5]=e=>q.runLibraryScanOnStart=e),label:e.$t("components.settings.library.runLibraryScanOnStart")},null,8,["modelValue","label"])):(0,t.kq)("",!0)]),(0,t.Wm)($,{class:"q-my-lg"}),(0,t.Wm)("h5",d,(0,a.zw)(e.$t("components.settings.library.fileMonitor")),1),(0,t.Wm)("div",p,[null===q.enableLibraryFileMonitor?((0,t.wg)(),(0,t.j4)(L,{key:0,type:"QToggle"})):((0,t.wg)(),(0,t.j4)(V,{key:1,modelValue:q.enableLibraryFileMonitor,"onUpdate:modelValue":l[6]||(l[6]=e=>q.enableLibraryFileMonitor=e),label:e.$t("components.settings.library.enableLibraryFileMonitor")},null,8,["modelValue","label"]))]),(0,t.Wm)("div",null,[(0,t.Wm)(F,{label:e.$t("navigation.submit"),type:"submit",color:"secondary"},null,8,["label"])])])),_:1},8,["onSubmit"])])])]),e.$q.platform.is.mobile?((0,t.wg)(),(0,t.j4)("div",h,[(0,t.Wm)($,{class:"q-mb-lg"}),(0,t.Wm)("div",g,[S,(0,t.Wm)("div",k,[(0,t.Wm)(Q,{flat:"",bordered:"",onClick:l[7]||(l[7]=l=>e.$router.push("/ui/settings-workers")),class:"bg-grey-1 q-ma-xs"},{default:(0,t.w5)((()=>[(0,t.Wm)(F,{"icon-right":"navigate_next",flat:""},{default:(0,t.w5)((()=>[w])),_:1})])),_:1})])])])):(0,t.kq)("",!0)])])),_:1})}var q=n(4190),_=n(1959),L=n(8825),v=n(5948),W=n(1536),$=n(52),V=n.n($),F=n(7689);const P={name:"SettingsLibrary",setup(){(0,L.Z)();const{t:e}=(0,v.QT)();let l=null,n=(0,q.A)(e);function a(){l=n.init()}function r(){n.close()}(0,t.bv)((()=>{a()})),(0,t.Ah)((()=>{r()}))},data(){return{libraryPath:(0,_.iH)(null),enableLibraryScanner:(0,_.iH)(null),libraryScanSchedule:(0,_.iH)(null),libraryScanFollowSymlinks:(0,_.iH)(null),runLibraryScanOnStart:(0,_.iH)(null),enableLibraryFileMonitor:(0,_.iH)(null)}},methods:{updateLibraryWithDirectoryBrowser:function(){this.$q.dialog({component:W.Z,componentProps:{dialogHeader:this.$t("headers.selectDirectory"),initialPath:this.libraryPath,listType:"directories"}}).onOk((e=>{"undefined"!==typeof e.selectedPath&&null!==e.selectedPath&&(this.libraryPath=e.selectedPath)})).onDismiss((()=>{}))},fetchSettings:function(){V()({method:"get",url:(0,F.J4)("v2","settings/read")}).then((e=>{this.libraryPath=e.data.settings.library_path,this.enableLibraryScanner=e.data.settings.enable_library_scanner,this.libraryScanSchedule=e.data.settings.schedule_full_scan_minutes,this.libraryScanFollowSymlinks=e.data.settings.follow_symlinks,this.runLibraryScanOnStart=e.data.settings.run_full_scan_on_start,this.enableLibraryFileMonitor=e.data.settings.enable_inotify})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToFetchSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},save:function(){let e={settings:{library_path:this.libraryPath,enable_library_scanner:this.enableLibraryScanner,schedule_full_scan_minutes:this.libraryScanSchedule,follow_symlinks:this.libraryScanFollowSymlinks,run_full_scan_on_start:this.runLibraryScanOnStart,enable_inotify:this.enableLibraryFileMonitor}};V()({method:"post",url:(0,F.J4)("v2","settings/write"),data:e}).then((e=>{this.fetchSettings(),this.$q.notify({color:"positive",position:"top",icon:"cloud_done",message:this.$t("notifications.saved"),timeout:200})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToSaveSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}},created(){this.fetchSettings()}};var Q=n(4379),j=n(5269),Z=n(4103),O=n(4842),T=n(4554),C=n(5869),M=n(8886),H=n(2165),U=n(151),x=n(7518),D=n.n(x);P.render=f;const z=P;D()(P,"components",{QPage:Q.Z,QForm:j.Z,QSkeleton:Z.ZP,QInput:O.Z,QIcon:T.Z,QSeparator:C.Z,QToggle:M.Z,QBtn:H.Z,QCard:U.Z})}}]);